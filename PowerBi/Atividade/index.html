<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutorial Power BI - Análise de Estoque Completo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .progress-bar {
            height: 5px;
            background: rgba(255,255,255,0.3);
            margin-top: 20px;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #fff;
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 3px;
        }

        .tutorial-content {
            padding: 30px;
        }

        .step-navigation {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 15px;
            flex-wrap: wrap;
        }

        .step-nav-btn {
            padding: 10px 20px;
            border: 2px solid #0078d4;
            background: white;
            color: #0078d4;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .step-nav-btn.active {
            background: #0078d4;
            color: white;
        }

        .step-nav-btn.completed {
            background: #28a745;
            border-color: #28a745;
            color: white;
        }

        .step-nav-btn:hover:not(.active) {
            background: #f8f9fa;
        }

        .step {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .step-title {
            font-size: 2.2em;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .step-number {
            background: #0078d4;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }

        .step-description {
            font-size: 1.1em;
            color: #666;
            margin-bottom: 20px;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .content-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            border-left: 5px solid #0078d4;
        }

        .content-section h3 {
            color: #0078d4;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .content-section ul {
            list-style: none;
            padding: 0;
        }

        .content-section li {
            margin: 10px 0;
            padding-left: 25px;
            position: relative;
        }

        .content-section li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            position: relative;
        }

        .code-block .code-title {
            color: #68d391;
            font-weight: bold;
            margin-bottom: 10px;
            display: block;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #4a5568;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .copy-btn:hover {
            background: #2d3748;
        }

        .highlight-box {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .highlight-box .icon {
            font-size: 1.5em;
            margin-right: 10px;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #e9ecef;
        }

        .nav-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-btn.prev {
            background: #6c757d;
            color: white;
        }

        .nav-btn.next {
            background: #0078d4;
            color: white;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .data-preview {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            overflow: hidden;
            margin: 15px 0;
        }

        .data-preview table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-preview th {
            background: #0078d4;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        .data-preview td {
            padding: 10px 12px;
            border-bottom: 1px solid #e9ecef;
        }

        .data-preview tr:nth-child(even) td {
            background: #f8f9fa;
        }

        .measure-formula {
            background: #e8f5e8;
            border: 1px solid #28a745;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }

        .visual-example {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .visual-placeholder {
            background: #e9ecef;
            height: 200px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            font-size: 1.1em;
            font-weight: 500;
        }

        .objective-box {
            background: linear-gradient(135deg, #e8f4f8 0%, #d1ecf1 100%);
            border: 2px solid #0078d4;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            position: relative;
        }

        .objective-box::before {
            content: "🎯";
            position: absolute;
            top: -15px;
            left: 20px;
            background: white;
            padding: 5px 10px;
            font-size: 1.5em;
        }

        .scenario-box {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px solid #6c757d;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            position: relative;
        }

        .scenario-box::before {
            content: "📋";
            position: absolute;
            top: -15px;
            left: 20px;
            background: white;
            padding: 5px 10px;
            font-size: 1.5em;
        }

        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .file-card {
            background: white;
            border: 2px solid #0078d4;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .file-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .file-icon {
            font-size: 3em;
            color: #0078d4;
            margin-bottom: 10px;
        }

        .file-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .file-description {
            color: #666;
            font-size: 0.9em;
        }

        .objectives-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .objective-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border: 1px solid #0078d4;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .objective-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            border-color: #28a745;
        }

        .objective-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            color: #0078d4;
        }

        .objective-card:hover .objective-icon {
            color: #28a745;
        }

        .alert-box {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            border: 2px solid #28a745;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            color: #155724;
        }

        .alert-icon {
            color: #28a745;
            margin-right: 8px;
            font-size: 1.2em;
        }

        @media (max-width: 768px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
            
            .step-navigation {
                flex-direction: column;
                align-items: center;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .step-title {
                font-size: 1.8em;
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📊 Tutorial Power BI - Análise de Estoque</h1>
            <p>Guia Completo para Criar Dashboard de Controle de Estoque</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
        </div>

        <div class="tutorial-content">
            <!-- Navegação por Steps -->
            <div class="step-navigation">
                <button class="step-nav-btn active" onclick="showStep(0)">1. Atividade</button>
                <button class="step-nav-btn" onclick="showStep(1)">2. Preparação</button>
                <button class="step-nav-btn" onclick="showStep(2)">3. Importação</button>
                <button class="step-nav-btn" onclick="showStep(3)">4. Modelagem</button>
                <button class="step-nav-btn" onclick="showStep(4)">5. Medidas DAX</button>
                <button class="step-nav-btn" onclick="showStep(5)">6. Visualizações</button>
                <button class="step-nav-btn" onclick="showStep(6)">7. Finalização</button>
            </div>

            <!-- Step 0: Descrição da Atividade -->
            <div class="step active" id="step0">
                <div class="step-header">
                    <div class="step-title">
                        <div class="step-number">📋</div>
                        <span>Atividade: Análise de Movimentações de Estoque</span>
                    </div>
                    <div class="step-description">Compreenda o contexto e objetivos do projeto</div>
                </div>

                <div class="objective-box">
                    <h3>🎯 Objetivo Principal</h3>
                    <p><strong>Desenvolver um modelo de dados no Power BI para analisar movimentações de estoque, identificar produtos críticos e entender o desempenho dos funcionários envolvidos nas operações.</strong></p>
                </div>

                <div class="scenario-box">
                    <h3>📊 Descrição da Atividade</h3>
                    <p>Você foi contratado como <strong>analista de dados</strong> para uma empresa de varejo que precisa otimizar seu controle de estoque. A empresa possui três bases de dados principais que precisam ser integradas e analisadas no Power BI.</p>
                </div>

                <h3 style="text-align: center; margin: 30px 0 20px 0; color: #0078d4;">📁 Arquivos Disponíveis</h3>
                <div class="files-grid">
                    <div class="file-card">
                        <div class="file-icon">📦</div>
                        <div class="file-title">produtos.csv</div>
                        <div class="file-description">
                            <strong>50 produtos</strong><br>
                            ID, nome, categoria, estoque mínimo
                        </div>
                    </div>
                    <div class="file-card">
                        <div class="file-icon">👥</div>
                        <div class="file-title">funcionarios.csv</div>
                        <div class="file-description">
                            <strong>20 funcionários</strong><br>
                            ID, nome, setor de atuação
                        </div>
                    </div>
                    <div class="file-card">
                        <div class="file-icon">📊</div>
                        <div class="file-title">movimentacoes.csv</div>
                        <div class="file-description">
                            <strong>1.500 registros</strong><br>
                            Entradas e saídas durante 2023
                        </div>
                    </div>
                </div>

                <h3 style="text-align: center; margin: 30px 0 20px 0; color: #0078d4;">🎯 Objetivos da Análise</h3>
                <div class="objectives-grid">
                    <div class="objective-card">
                        <div class="objective-icon">📈</div>
                        <h4>Dashboard de Monitoramento</h4>
                        <p>Criar um dashboard para monitoramento do estoque atual</p>
                    </div>
                    <div class="objective-card">
                        <div class="objective-icon">⚠️</div>
                        <h4>Produtos Críticos</h4>
                        <p>Identificar produtos que estão abaixo do estoque mínimo</p>
                    </div>
                    <div class="objective-card">
                        <div class="objective-icon">👤</div>
                        <h4>Performance dos Funcionários</h4>
                        <p>Analisar o desempenho dos funcionários nas movimentações</p>
                    </div>
                    <div class="objective-card">
                        <div class="objective-icon">📅</div>
                        <h4>Tendências Temporais</h4>
                        <p>Visualizar tendências de entrada e saída por período</p>
                    </div>
                    <div class="objective-card">
                        <div class="objective-icon">🚨</div>
                        <h4>Alertas Visuais</h4>
                        <p>Criar alertas visuais para produtos críticos</p>
                    </div>
                </div>

                <div class="data-preview">
                    <table>
                        <thead>
                            <tr><th colspan="4">📋 Resumo dos Dados Reais</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>📦 Produtos Cadastrados</strong></td><td>50 itens</td><td><strong>⚠️ Produtos Críticos</strong></td><td>46 itens</td></tr>
                            <tr><td><strong>👥 Funcionários Ativos</strong></td><td>20 pessoas</td><td><strong>📊 Total de Movimentações</strong></td><td>1.500 registros</td></tr>
                            <tr><td><strong>📅 Período Analisado</strong></td><td>Jan-Dez 2023</td><td><strong>🏢 Setores Envolvidos</strong></td><td>8 departamentos</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="highlight-box">
                    <span class="icon">💡</span>
                    <strong>Situação Crítica Identificada:</strong> Os dados reais mostram que 92% dos produtos (46 de 50) estão com estoque abaixo do mínimo recomendado, incluindo produtos com estoque negativo, indicando uma situação que requer ação imediata.
                </div>
            </div>

            <!-- Step 1: Preparação -->
            <div class="step" id="step1">
                <div class="step-header">
                    <div class="step-title">
                        <div class="step-number">1</div>
                        <span>Preparação dos Dados</span>
                    </div>
                    <div class="step-description">Configure seu ambiente e prepare os arquivos necessários</div>
                </div>

                <div class="content-grid">
                    <div class="content-section">
                        <h3>📁 Arquivos Necessários</h3>
                        <ul>
                            <li>funcionarios.csv (20 funcionários)</li>
                            <li>produtos.csv (50 produtos)</li>
                            <li>movimentacoes.csv (1.500 registros)</li>
                        </ul>
                    </div>

                    <div class="content-section">
                        <h3>⚙️ Requisitos</h3>
                        <ul>
                            <li>Power BI Desktop instalado</li>
                            <li>Arquivos CSV organizados</li>
                            <li>Conhecimento básico de Power BI</li>
                        </ul>
                    </div>
                </div>

                <div class="highlight-box">
                    <span class="icon">💡</span>
                    <strong>Dica Importante:</strong> Certifique-se de que todos os arquivos CSV estão salvos com codificação UTF-8 para evitar problemas com acentos e caracteres especiais.
                </div>

                <div class="data-preview">
                    <table>
                        <thead>
                            <tr><th colspan="3">📋 Estrutura dos Dados</th></tr>
                            <tr><th>Arquivo</th><th>Registros</th><th>Campos Principais</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>funcionarios.csv</td><td>20</td><td>ID_Funcionario, Nome, Setor</td></tr>
                            <tr><td>produtos.csv</td><td>50</td><td>ID, Nome, Categoria, Estoque Mínimo</td></tr>
                            <tr><td>movimentacoes.csv</td><td>1.500</td><td>Data, Tipo, Quantidade, ID_Produto, ID_Funcionario</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Step 2: Importação -->
            <div class="step" id="step2">
                <div class="step-header">
                    <div class="step-title">
                        <div class="step-number">2</div>
                        <span>Importação dos Dados</span>
                    </div>
                    <div class="step-description">Importe os arquivos CSV para o Power BI</div>
                </div>

                <div class="content-grid">
                    <div class="content-section">
                        <h3>📤 Passos para Importação</h3>
                        <ul>
                            <li>Abra o Power BI Desktop</li>
                            <li>Clique em "Obter Dados"</li>
                            <li>Selecione "Texto/CSV"</li>
                            <li>Escolha o primeiro arquivo</li>
                            <li>Repita para os outros 2 arquivos</li>
                        </ul>
                    </div>

                    <div class="content-section">
                        <h3>✅ Verificações Importantes</h3>
                        <ul>
                            <li>Verificar tipos de dados</li>
                            <li>Confirmar cabeçalhos das colunas</li>
                            <li>Validar formato de datas</li>
                            <li>Checar codificação de caracteres</li>
                        </ul>
                    </div>
                </div>

                <div class="code-block">
                    <span class="code-title">🔍 Configurações Recomendadas:</span>
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
Delimitador: , (vírgula)
Codificação: UTF-8
Primeira linha como cabeçalho: ✓
Detectar tipo de dados: ✓
                </div>

                <div class="highlight-box">
                    <span class="icon">⚠️</span>
                    <strong>Atenção:</strong> Se houver problemas de codificação, tente importar com diferentes codificações (UTF-8, Windows-1252) até que os acentos apareçam corretamente.
                </div>
            </div>

            <!-- Step 3: Modelagem -->
            <div class="step" id="step3">
                <div class="step-header">
                    <div class="step-title">
                        <div class="step-number">3</div>
                        <span>Modelagem de Dados</span>
                    </div>
                    <div class="step-description">Crie relacionamentos entre as tabelas e configure colunas calculadas</div>
                </div>

                <div class="content-grid">
                    <div class="content-section">
                        <h3>🔗 Relacionamentos</h3>
                        <ul>
                            <li>movimentacoes[ID_Produto] → produtos[ID]</li>
                            <li>movimentacoes[ID_Funcionario] → funcionarios[ID_Funcionario]</li>
                            <li>Cardinalidade: Muitos para Um</li>
                            <li>Direção do filtro: Unidirecional</li>
                        </ul>
                    </div>

                    <div class="content-section">
                        <h3>📊 Colunas Calculadas</h3>
                        <ul>
                            <li>Ano da Movimentação</li>
                            <li>Mês da Movimentação</li>
                            <li>Quantidade com Sinal</li>
                            <li>Status do Produto</li>
                        </ul>
                    </div>
                </div>

                <div class="highlight-box">
                    <span class="icon">📋</span>
                    <strong>Passo a Passo:</strong> Primeiro configure os relacionamentos, depois crie as colunas calculadas na tabela movimentacoes para facilitar as análises futuras.
                </div>

                <h3 style="text-align: center; margin: 30px 0 20px 0; color: #0078d4;">📊 Fórmulas DAX para Colunas Calculadas</h3>

                <div class="measure-formula">
                    <strong>📅 1. Ano da Movimentação:</strong>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
Ano = YEAR(movimentacoes[Data])
                    </div>
                    <p style="margin-top: 10px; color: #666; font-size: 0.9em;">
                        <strong>Resultado:</strong> Esta fórmula extrai o ano da coluna Data. Com base nos dados, resultará em <strong>2023</strong> para todas as movimentações.
                    </p>
                </div>

                <div class="measure-formula">
                    <strong>📅 2. Mês da Movimentação:</strong>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
Mês = FORMAT(movimentacoes[Data], "MMMM YYYY")
                    </div>
                    <p style="margin-top: 10px; color: #666; font-size: 0.9em;">
                        <strong>Alternativas:</strong>
                    </p>
                    <div class="code-block" style="margin-top: 10px;">
                        <span class="code-title">Apenas número do mês:</span>
                        <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
MêsNumero = MONTH(movimentacoes[Data])
                    </div>
                    <div class="code-block" style="margin-top: 10px;">
                        <span class="code-title">Mês abreviado:</span>
                        <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
MêsAbrev = FORMAT(movimentacoes[Data], "MMM YYYY")
                    </div>
                    <p style="margin-top: 10px; color: #666; font-size: 0.9em;">
                        <strong>Resultado:</strong> "Janeiro 2023", "Fevereiro 2023", etc.
                    </p>
                </div>

                <div class="measure-formula">
                    <strong>➕➖ 3. Quantidade com Sinal:</strong>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
QuantidadeComSinal = 
IF(
    movimentacoes[Tipo] = "Entrada",
    movimentacoes[Quantidade],
    -movimentacoes[Quantidade]
)
                    </div>
                    <p style="margin-top: 10px; color: #666; font-size: 0.9em;">
                        <strong>Funcionalidade:</strong> Transforma entradas em valores positivos (+85) e saídas em valores negativos (-97), facilitando cálculos de estoque.
                    </p>
                </div>

                <div class="measure-formula">
                    <strong>🏷️ 4. Status do Produto:</strong>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
StatusProduto = 
VAR EstoqueAtual = 
    CALCULATE(
        SUMX(
            FILTER(movimentacoes, movimentacoes[ID_Produto] = EARLIER(movimentacoes[ID_Produto])),
            IF(movimentacoes[Tipo] = "Entrada", movimentacoes[Quantidade], -movimentacoes[Quantidade])
        )
    )
VAR EstoqueMinimo = 
    RELATED(produtos[Estoque Mínimo])
RETURN
    SWITCH(
        TRUE(),
        EstoqueAtual < 0, "🔴 CRÍTICO - NEGATIVO",
        EstoqueAtual = 0, "🟡 ZERADO",
        EstoqueAtual < EstoqueMinimo, "🟠 ABAIXO DO MÍNIMO", 
        EstoqueAtual >= EstoqueMinimo, "🟢 NORMAL"
    )
                    </div>
                    <p style="margin-top: 10px; color: #666; font-size: 0.9em;">
                        <strong>Versão Simplificada (alternativa):</strong>
                    </p>
                    <div class="code-block" style="margin-top: 10px;">
                        <span class="code-title">Para relacionamento direto:</span>
                        <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
StatusSimples = 
IF(
    RELATED(produtos[Estoque Mínimo]) > 50,
    "Alto Mínimo",
    "Baixo Mínimo"
)
                    </div>
                </div>

                <div class="data-preview">
                    <table>
                        <thead>
                            <tr><th colspan="5">📋 Exemplo dos Resultados Esperados</th></tr>
                            <tr><th>Movimentação ID</th><th>Ano</th><th>Mês</th><th>Quantidade com Sinal</th><th>Status</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>1</td><td>2023</td><td>Setembro 2023</td><td>-97</td><td>🔴 CRÍTICO</td></tr>
                            <tr><td>2</td><td>2023</td><td>Março 2023</td><td>+85</td><td>🟢 NORMAL</td></tr>
                            <tr><td>8</td><td>2023</td><td>Setembro 2023</td><td>-52</td><td>🔴 CRÍTICO</td></tr>
                            <tr><td>9</td><td>2023</td><td>Dezembro 2023</td><td>-96</td><td>🔴 CRÍTICO</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="highlight-box">
                    <span class="icon">🔧</span>
                    <strong>Como Implementar:</strong>
                    <ol style="margin: 10px 0; padding-left: 20px;">
                        <li>Selecione a tabela <strong>movimentacoes</strong> no painel Campos</li>
                        <li>Clique com botão direito → <strong>Nova coluna</strong></li>
                        <li>Digite a fórmula DAX correspondente</li>
                        <li>Pressione <strong>Enter</strong> para confirmar</li>
                        <li>Repita para todas as 4 colunas</li>
                    </ol>
                </div>

                <div class="visual-example">
                    <div class="visual-placeholder">
                        🔗 Diagrama de Relacionamentos + Colunas Calculadas<br>
                        funcionarios ← movimentacoes → produtos<br>
                        📊 + 4 Novas Colunas Calculadas
                    </div>
                </div>

                <div class="alert-box">
                    <span class="alert-icon">💡</span>
                    <strong>Dicas Importantes:</strong>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li><strong>Performance:</strong> Use RELATED() apenas quando necessário para buscar dados de tabelas relacionadas</li>
                        <li><strong>Validação:</strong> Teste as fórmulas com uma amostra pequena antes de aplicar em todo o dataset</li>
                        <li><strong>Alternativas:</strong> Para cálculos mais complexos de estoque, considere usar Medidas DAX ao invés de colunas calculadas</li>
                        <li><strong>Formatação:</strong> A função FORMAT() é útil para criar textos personalizados para datas</li>
                    </ul>
                </div>
            </div>

            <!-- Step 4: Medidas DAX -->
            <div class="step" id="step4">
                <div class="step-header">
                    <div class="step-title">
                        <div class="step-number">4</div>
                        <span>Criação de Medidas DAX</span>
                    </div>
                    <div class="step-description">Desenvolva as fórmulas para os indicadores principais</div>
                </div>

                <div class="measure-formula">
                    <strong>📊 Estoque Atual:</strong><br>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
EstoqueAtual = 
SUMX(
    produtos,
    CALCULATE(
        SUMX(
            movimentacoes,
            IF(movimentacoes[Tipo] = "Entrada", 
               movimentacoes[Quantidade], 
               -movimentacoes[Quantidade])
        )
    )
)
                    </div>
                </div>

                <div class="measure-formula">
                    <strong>⚠️ Produtos Críticos:</strong><br>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
ProdutosCriticos = 
CALCULATE(
    COUNTROWS(produtos),
    FILTER(
        produtos,
        [EstoqueAtual] < produtos[Estoque Mínimo]
    )
)
                    </div>
                </div>

                <div class="measure-formula">
                    <strong>👤 Total Movimentado por Funcionário:</strong><br>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
TotalMovimentadoFuncionario = 
CALCULATE(
    SUM(movimentacoes[Quantidade])
)
                    </div>
                </div>

                <div class="highlight-box">
                    <span class="icon">🎯</span>
                    <strong>Resultado Esperado:</strong> Com essas medidas você conseguirá identificar que existem 46 produtos em situação crítica (abaixo do estoque mínimo) dos 50 produtos cadastrados.
                </div>
            </div>

            <!-- Step 5: Visualizações -->
            <div class="step" id="step5">
                <div class="step-header">
                    <div class="step-title">
                        <div class="step-number">5</div>
                        <span>Criação das Visualizações</span>
                    </div>
                    <div class="step-description">Monte os gráficos e componentes do dashboard</div>
                </div>

                <div class="content-grid">
                    <div class="content-section">
                        <h3>📊 Cartões KPI</h3>
                        <ul>
                            <li>Total de Produtos: 50</li>
                            <li>Produtos Críticos: 46</li>
                            <li>Total de Funcionários: 20</li>
                        </ul>
                    </div>

                    <div class="content-section">
                        <h3>📈 Gráficos Principais</h3>
                        <ul>
                            <li>Gráfico de Barras: Estoque por Produto</li>
                            <li>Gráfico de Colunas: Movimentações por Funcionário</li>
                            <li>Gráfico de Linhas: Tendência Temporal</li>
                        </ul>
                    </div>
                </div>

                <div class="data-preview">
                    <table>
                        <thead>
                            <tr><th colspan="4">📋 Tabela: Produtos Críticos</th></tr>
                            <tr><th>Produto</th><th>Estoque Atual</th><th>Estoque Mínimo</th><th>Status</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Dobradiça Inox 3"</td><td>-96</td><td>60</td><td>🔴 CRÍTICO</td></tr>
                            <tr><td>Chumbador Mecânico M10</td><td>-52</td><td>40</td><td>🔴 CRÍTICO</td></tr>
                            <tr><td>Tranca de Portão</td><td>-25</td><td>30</td><td>🔴 CRÍTICO</td></tr>
                            <tr><td>Parafuso Phillips 3mm</td><td>0</td><td>100</td><td>🟡 ZERADO</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="highlight-box">
                    <span class="icon">🎨</span>
                    <strong>Dicas de Formatação:</strong> Use formatação condicional para destacar produtos críticos em vermelho, produtos zerados em amarelo e produtos normais em verde.
                </div>
            </div>

            <!-- Step 6: Finalização -->
            <div class="step" id="step6">
                <div class="step-header">
                    <div class="step-title">
                        <div class="step-number">6</div>
                        <span>Finalização e Testes</span>
                    </div>
                    <div class="step-description">Configure filtros, temas e publique o dashboard</div>
                </div>

                <div class="content-grid">
                    <div class="content-section">
                        <h3>🎨 Formatação Final</h3>
                        <ul>
                            <li>Aplicar tema corporativo</li>
                            <li>Configurar cores condicionais</li>
                            <li>Adicionar logotipos</li>
                            <li>Ajustar tamanhos e posições</li>
                        </ul>
                    </div>

                    <div class="content-section">
                        <h3>🔍 Testes e Validação</h3>
                        <ul>
                            <li>Testar todos os filtros</li>
                            <li>Validar cálculos</li>
                            <li>Verificar interatividade</li>
                            <li>Testar em diferentes resoluções</li>
                        </ul>
                    </div>
                </div>

                <div class="highlight-box">
                    <span class="icon">🎯</span>
                    <strong>Resultado Final:</strong> Um dashboard completo que permite monitorar 50 produtos, identificar 46 produtos críticos e analisar o desempenho de 20 funcionários através de 1.500 movimentações registradas em 2023.
                </div>

                <div class="visual-example">
                    <div class="visual-placeholder">
                        🎉 Dashboard Completo<br>
                        ✅ KPIs | ✅ Gráficos | ✅ Tabelas | ✅ Filtros
                    </div>
                </div>

                <div class="code-block">
                    <span class="code-title">📋 Checklist Final:</span>
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copiar</button>
☑️ Dados importados corretamente
☑️ Relacionamentos configurados
☑️ Colunas calculadas criadas
☑️ Medidas DAX funcionando
☑️ Visualizações criadas
☑️ Formatação aplicada
☑️ Testes realizados
☑️ Dashboard publicado
                </div>
            </div>

            <!-- Botões de Navegação -->
            <div class="navigation-buttons">
                <button class="nav-btn prev" onclick="previousStep()" id="prevBtn" disabled>
                    ← Anterior
                </button>
                <button class="nav-btn next" onclick="nextStep()" id="nextBtn">
                    Próximo →
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 0;
        const totalSteps = 7;
        const completedSteps = new Set();

        function showStep(stepIndex) {
            // Hide all steps
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            
            // Show selected step
            document.getElementById(`step${stepIndex}`).classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.step-nav-btn').forEach((btn, index) => {
                btn.classList.remove('active');
                if (index === stepIndex) {
                    btn.classList.add('active');
                }
                if (completedSteps.has(index)) {
                    btn.classList.add('completed');
                }
            });
            
            // Update progress bar
            const progress = ((stepIndex + 1) / totalSteps) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            
            // Update navigation buttons
            document.getElementById('prevBtn').disabled = stepIndex === 0;
            document.getElementById('nextBtn').disabled = stepIndex === totalSteps - 1;
            
            if (stepIndex === totalSteps - 1) {
                document.getElementById('nextBtn').innerHTML = '🎉 Concluído';
            } else {
                document.getElementById('nextBtn').innerHTML = 'Próximo →';
            }
            
            currentStep = stepIndex;
        }

        function nextStep() {
            if (currentStep < totalSteps - 1) {
                completedSteps.add(currentStep);
                showStep(currentStep + 1);
            }
        }

        function previousStep() {
            if (currentStep > 0) {
                showStep(currentStep - 1);
            }
        }

        function copyToClipboard(button) {
            const codeBlock = button.parentNode;
            const text = codeBlock.textContent.replace('Copiar', '').trim();
            
            navigator.clipboard.writeText(text).then(() => {
                button.innerHTML = '✓ Copiado';
                button.style.background = '#28a745';
                
                setTimeout(() => {
                    button.innerHTML = 'Copiar';
                    button.style.background = '#4a5568';
                }, 2000);
            }).catch(err => {
                // Fallback para navegadores mais antigos
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                button.innerHTML = '✓ Copiado';
                button.style.background = '#28a745';
                
                setTimeout(() => {
                    button.innerHTML = 'Copiar';
                    button.style.background = '#4a5568';
                }, 2000);
            });
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft' && currentStep > 0) {
                previousStep();
            } else if (e.key === 'ArrowRight' && currentStep < totalSteps - 1) {
                nextStep();
            }
        });

        // Auto-save progress
        window.addEventListener('beforeunload', () => {
            localStorage.setItem('powerbi_tutorial_progress', JSON.stringify({
                currentStep: currentStep,
                completedSteps: Array.from(completedSteps)
            }));
        });

        // Load saved progress
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('powerbi_tutorial_progress');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    data.completedSteps.forEach(step => completedSteps.add(step));
                    showStep(data.currentStep);
                } catch (e) {
                    console.log('Erro ao carregar progresso salvo');
                }
            }
        });

        // Initialize
        showStep(0);
    </script>
</body>
</html>
